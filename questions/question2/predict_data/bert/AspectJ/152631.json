{"id": "152631", "title": "Bug 152631Problem with decp on an aspect using cflow", "description": " Bug 152631Problem with decp on an aspect using cflow This occurs in the AspectJ build in AJDT from August 1 but not from July 31:java.lang.NullPointerExceptionat org.aspectj.weaver.bcel.BcelTypeMunger.enforceDecpRule1abstractMethodsImplemented(BcelTypeMunger.java:250)at org.aspectj.weaver.bcel.BcelTypeMunger.mungeNewParent(BcelTypeMunger.java:194)at org.aspectj.weaver.bcel.BcelTypeMunger.munge(BcelTypeMunger.java:106)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:454)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:119)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1597)at org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:1548)at org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:1328)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1124)at org.aspectj.ajdt.internal.compiler.AjPipeliningCompilerAdapter.weaveQueuedEntries(AjPipeliningCompilerAdapter.java:451)at org.aspectj.ajdt.internal.compiler.AjPipeliningCompilerAdapter.queueForWeaving(AjPipeliningCompilerAdapter.java:389)at org.aspectj.ajdt.internal.compiler.AjPipeliningCompilerAdapter.afterProcessing(AjPipeliningCompilerAdapter.java:377)at org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$after$orgaspectjajdtinternalcompilerCompilerAdapter$5$6b855184(CompilerAdapter.aj:98)at org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.process(Compiler.java:533)at org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:329)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:891)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:246)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBuildManager.java:165)at org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:122)at org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)trouble in:public class glassbox.agent.ErrorContainmentTest$ErrorMockAspect extends java.lang.Object implements glassbox.agent.api.NotSerializable:private static Throwable ajc$initFailureCause [Synthetic]public static final glassbox.agent.ErrorContainmentTest$ErrorMockAspect ajc$perSingletonInstance [Synthetic]static void <clinit():catch java.lang.ThrowableE0|INVOKESTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$postClinit ()V(line 60)catch java.lang.ThrowableE0GOTO L0E0: ASTORE0ALOAD0PUTSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$initFailureCause Ljava/lang/Throwable;L0: RETURNend static void <clinit()void <init():ALOAD0// Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect; this(line 60)INVOKESPECIAL java.lang.Object.<init ()VRETURNend void <init()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$1$9589fc()AdviceAttribute(before, (scope() && call( hook1())), 0, 1670):NEW java.lang.RuntimeException(line 64)DUPLDC \"rte\"INVOKESPECIAL java.lang.RuntimeException.<init (Ljava/lang/String;)VATHROWend public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$1$9589fc()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$2$f75db3e2()AdviceAttribute(before, execution( glassbox.agent.ErrorContainmentTest.hook5()), 0, 1764):NEW java.lang.RuntimeException(line 67)DUPLDC \"rte\"INVOKESPECIAL java.lang.RuntimeException.<init (Ljava/lang/String;)VATHROWend public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$2$f75db3e2()public void ajc$around$glassboxagentErrorContainmentTest$ErrorMockAspect$3$a3a17d(org.aspectj.runtime.internal.AroundClosure)AdviceAttribute(around, (scope() && call( hook2())), 1, 1913):NEW java.lang.Error(line 71)DUPLDC \"foo\"INVOKESPECIAL java.lang.Error.<init (Ljava/lang/String;)VATHROWend public void ajc$around$glassboxagentErrorContainmentTest$ErrorMockAspect$3$a3a17d(org.aspectj.runtime.internal.AroundClosure)static void ajc$around$glassboxagentErrorContainmentTest$ErrorMockAspect$3$a3a17dproceed(org.aspectj.runtime.internal.AroundClosure) throws java.lang.Throwableorg.aspectj.weaver.AjAttribute$AjSynthetic@19a01f9:ALOAD0// Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect; this(line 1)ICONST0ANEWARRAY java.lang.ObjectINVOKEVIRTUAL org.aspectj.runtime.internal.AroundClosure.run ([Ljava/lang/Object;)Ljava/lang/Object;INVOKESTATIC org.aspectj.runtime.internal.Conversions.voidValue (Ljava/lang/Object;)Ljava/lang/Object;RETURNend static void ajc$around$glassboxagentErrorContainmentTest$ErrorMockAspect$3$a3a17dproceed(org.aspectj.runtime.internal.AroundClosure) throws java.lang.Throwablepublic void ajc$after$glassboxagentErrorContainmentTest$ErrorMockAspect$4$bfd07f()AdviceAttribute(after, (scope() && call( hook4())), 0, 1991):NEW org.aspectj.lang.SoftException(line 74)DUPACONSTNULLINVOKESPECIAL org.aspectj.lang.SoftException.<init (Ljava/lang/Throwable;)VATHROWend public void ajc$after$glassboxagentErrorContainmentTest$ErrorMockAspect$4$bfd07f()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$5$e5bddfdc()AdviceAttribute(before, logErrorInTest(), 0, 2446):GETSTATIC glassbox.agent.ErrorContainmentTest.logCount I(line 84)ICONST1IADDPUTSTATIC glassbox.agent.ErrorContainmentTest.logCount IRETURN(line 85)end public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$5$e5bddfdc()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$6$16ecfe62()AdviceAttribute(before, (adviceexecution( ) && (within(glassbox.util.logging.api.LogManagement) && (cflow(logError()) && cflow((execution( testLoggingError(..)) && within(glassbox.agent.ErrorContainmentTest)))))), 0, 2506):GETSTATIC java.lang.System.err Ljava/io/PrintStream;(line 87)LDC \"match\"INVOKEVIRTUAL java.io.PrintStream.println (Ljava/lang/String;)VRETURN(line 88)end public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$6$16ecfe62()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$7$e9ae8482()AdviceAttribute(before, (adviceexecution( ) && (within(glassbox.util.logging.api.LogManagement) && cflow((execution( testLoggingError(..)) && within(glassbox.agent.ErrorContainmentTest))))), 0, 2721):GETSTATIC java.lang.System.err Ljava/io/PrintStream;(line 90)LDC \"match in test\"INVOKEVIRTUAL java.io.PrintStream.println (Ljava/lang/String;)VRETURN(line 91)end public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$7$e9ae8482()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$8$c6ac5351()AdviceAttribute(before, (adviceexecution( ) && (within(glassbox.util.logging.api.LogManagement) && cflow(logError()))), 0, 2923):GETSTATIC java.lang.System.err Ljava/io/PrintStream;(line 93)LDC \"match in log\"INVOKEVIRTUAL java.io.PrintStream.println (Ljava/lang/String;)VRETURN(line 94)end public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$8$c6ac5351()public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$9$16ecfe62()AdviceAttribute(before, (adviceexecution( ) && (within(glassbox.util.logging.api.LogManagement) && (cflow(logError()) && cflow((execution( testLoggingError(..)) && within(glassbox.agent.ErrorContainmentTest)))))), 0, 3069):GETSTATIC glassbox.agent.ErrorContainmentTest.recursiveThrows I(line 96)ICONST1IADDPUTSTATIC glassbox.agent.ErrorContainmentTest.recursiveThrows IGETSTATIC glassbox.agent.ErrorContainmentTest.recursiveThrows I(line 97)ICONST2IFICMPGE L0NEW java.lang.RuntimeException(line 98)DUPLDC \"recursive logging failure\"INVOKESPECIAL java.lang.RuntimeException.<init (Ljava/lang/String;)VATHROWL0: RETURN(line 100)end public void ajc$before$glassboxagentErrorContainmentTest$ErrorMockAspect$9$16ecfe62()public static glassbox.agent.ErrorContainmentTest$ErrorMockAspect aspectOf()org.aspectj.weaver.AjAttribute$AjSynthetic@3cd8fe:GETSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$perSingletonInstance Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect;(line 1)IFNONNULL L0NEW org.aspectj.lang.NoAspectBoundExceptionDUPLDC \"glassboxagentErrorContainmentTest$ErrorMockAspect\"GETSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$initFailureCause Ljava/lang/Throwable;INVOKESPECIAL org.aspectj.lang.NoAspectBoundException.<init (Ljava/lang/String;Ljava/lang/Throwable;)VATHROWL0: GETSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$perSingletonInstance Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect;ARETURNend public static glassbox.agent.ErrorContainmentTest$ErrorMockAspect aspectOf()public static boolean hasAspect()org.aspectj.weaver.AjAttribute$AjSynthetic@1bd4f6:GETSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$perSingletonInstance Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect;(line 1)IFNULL L0ICONST1IRETURNL0: ICONST0IRETURNend public static boolean hasAspect()private static void ajc$postClinit()org.aspectj.weaver.AjAttribute$AjSynthetic@1febf91:NEW glassbox.agent.ErrorContainmentTest$ErrorMockAspect(line 1)DUPINVOKESPECIAL glassbox.agent.ErrorContainmentTest$ErrorMockAspect.<init ()VPUTSTATIC glassbox.agent.ErrorContainmentTest$ErrorMockAspect.ajc$perSingletonInstance Lglassbox/agent/ErrorContainmentTest$ErrorMockAspect;RETURNend private static void ajc$postClinit()end public class glassbox.agent.ErrorContainmentTest$ErrorMockAspectwhen type munging with (BcelTypeMunger ResolvedTypeMunger(Parent, null))when weaving aspectswhen weavingwhen batch building BuildConfig[C:\\devel\\glassbox\\.metadata\\.plugins\\org.eclipse.ajdt.core\\glassboxMonitor.generated.lst] Files=107The source is:public class ErrorContainmentTest extends TestCase {...static aspect ErrorMockAspect implements NotSerializable {...I will try to narrow this down if the problem isn't obvious.", "OB": "", "EB": "", "SR": ""}