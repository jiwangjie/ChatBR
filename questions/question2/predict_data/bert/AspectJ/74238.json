{"id": "74238", "title": "Bug 74238Applet which uses cflow pointcut gets AccessControlException", "description": " When I used cflow pointcut for my applet, I couldn't launch the Applet.java.lang.ExceptionInInitializerErrorat SandAspect.ajc$preClinit(SandAspect.aj)at SandAspect.<clinit(SandAspect.aj)at SandApplet.init(SandApplet.java)at sun.applet.AppletPanel.run(AppletPanel.java:353)at java.lang.Thread.run(Thread.java:534)Caused by: java.security.AccessControlException: access denied (java.util.PropertyPermission aspectj.runtime.cflowstack.usethreadlocal read)at java.security.AccessControlContext.checkPermission(AccessControlContext.java:269)at java.security.AccessController.checkPermission(AccessController.java:401)at java.lang.SecurityManager.checkPermission(SecurityManager.java:524)at java.lang.SecurityManager.checkPropertyAccess(SecurityManager.java:1276)at java.lang.System.getProperty(System.java:612)at org.aspectj.runtime.internal.CFlowStack.selectFactoryForVMVersion(CFlowStack.java:124)at org.aspectj.runtime.internal.CFlowStack.<clinit(CFlowStack.java:59)... 5 moreIt because CFlowStack uses System.getProperty method with no try..catch block.Applet doesn't have permission to read system property:\"aspectj.runtime.cflowstack.usethreadlocal\".workaround:modify CFlowStack.java(1.5) line 123,124 like thisprivate static String getSystemPropertyWithNoSecurityException(String aPropertyName, String aDefaultValue){try{return System.getProperty(aPropertyName, aDefaultValue);} catch(java.lang.SecurityException e){return aDefaultValue;}}private static void selectFactoryForVMVersion() {String override = getSystemPropertyWithNoSecurityException(\"aspectj.runtime.cflowstack.usethreadlocal\", \"unspecified\");I think defining getSystemPropertyWithNoSecurityException(or moresimple name :)) method in some utility class and using it where you callSystem.getProperty are better way.", "OB": " Bug 74238Applet which uses cflow pointcut gets AccessControlException", "EB": "", "SR": ""}