{"id": "24402", "title": "Bug 24402OLE part have a access violation exception", "description": " Bug 24402OLE part have a access violation exception First time to report a bug hereand new to eclipse.This bug is relating to the OLE part, so only appear on Windows platform.I am trying to put some ActiveX control in my application, and I need to get aIDispatch property of an OleAutomation.I call OleAutomation.getProperty(), this function will then invoke theunderlying IDispatch.invoke(), and later call into Variant.setData() to copy theresult into the Variant structure.In the Variant.setData() function, there is something as:case COM.VTDISPATCH : {int[] ppvObject = new int[1];OS.MoveMemory(ppvObject, pData + 8, 4);dispatchData = new IDispatch(ppvObject[0]);dispatchData.AddRef();break;}This is for when the return type is VTDISPATCH, then create a IDispatch objectand AddRef() to it. Unfortunately, ppvObject[0] can be null.", "OB": "", "EB": " In this case,AddRef() crash the system.I believe, this part of code should be:case COM.VTDISPATCH : {int[] ppvObject = new int[1];OS.MoveMemory(ppvObject, pData + 8, 4);if (ppvObject[0]!=null) {dispatchData = new IDispatch(ppvObject[0]);dispatchData.AddRef();} else {dispatchData = null;}break;}BTW I like SWT very much.", "SR": ""}