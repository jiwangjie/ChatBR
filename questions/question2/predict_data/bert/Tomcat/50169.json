{"id": "50169", "title": "Bug 50169Trying to register wrapper and welcomeFile to Mapper before context is registered on Mapper.", "description": " Created attachment 26220 [details]patch for StandardContext and StandardWrapperWhen I used \"Host start operation\" via JMX, I got error messages.2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWelcomeFileSEVERE: No context found:At first StandardHost starts /manager context. (1) LifecycleState is STARTINGPREP now. Wrapper is not registered because host has not been registered.Mapper.addWrapper(String, String, String, Object, boolean) line: 331MapperListener.containerEvent(ContainerEvent) line: 169StandardWrapper(ContainerBase).fireContainerEvent(String, Object) line: 1253StandardWrapper.addMapping(String) line: 740StandardContext.addServletMapping(String, String, boolean) line: 2921StandardContext.addServletMapping(String, String) line: 2881WebXml.configureContext(Context) line: 1274ContextConfig.webConfig() line: 1283ContextConfig.configureStart() line: 881ContextConfig.lifecycleEvent(LifecycleEvent) line: 315LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext.startInternal() line: 4834StandardContext(LifecycleBase).start() line: 140StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140(2) Set LifecycleState to STARTED. Register context and host on Mapper.Mapper.addHost(String, String[], Object) line: 96Mapper.addContext(String, Object, String, Object, String[], Context) line: 226MapperListener.registerContext(Context) line: 339MapperListener.lifecycleEvent(LifecycleEvent) line: 411LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext(LifecycleBase).setState(LifecycleState, Object) line: 325StandardContext(LifecycleBase).setState(LifecycleState) line: 305StandardContext(LifecycleBase).start() line: 156StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140(3) Register wrapper again. It succeeds because context has been registered on Mapper.Mapper.addWrapper(String, String, String, Object, boolean) line: 328MapperListener.registerWrapper(Wrapper) line: 394MapperListener.registerContext(Context) line: 343MapperListener.lifecycleEvent(LifecycleEvent) line: 411LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext(LifecycleBase).setState(LifecycleState, Object) line: 325StandardContext(LifecycleBase).setState(LifecycleState) line: 305StandardContext(LifecycleBase).start() line: 156StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140Next, StandardHost starts ROOT context.", "OB": " Then, gets error as follows because context has not been registered.2010/10/28 11:04:10 org.apache.tomcat.util.http.mapper.Mapper addWrapperSEVERE: No context found:Mapper.addWrapper(String, String, String, Object, boolean) line: 338MapperListener.containerEvent(ContainerEvent) line: 169StandardWrapper(ContainerBase).fireContainerEvent(String, Object) line: 1253StandardWrapper.addMapping(String) line: 740StandardContext.addServletMapping(String, String, boolean) line: 2921StandardContext.addServletMapping(String, String) line: 2881WebXml.configureContext(Context) line: 1274ContextConfig.webConfig() line: 1283ContextConfig.configureStart() line: 881ContextConfig.lifecycleEvent(LifecycleEvent) line: 315LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext.startInternal() line: 4834StandardContext(LifecycleBase).start() line: 140StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140(5) Set LifecycleState to STARTED, and register context.Mapper.addContext(String, Object, String, Object, String[], Context) line: 223MapperListener.registerContext(Context) line: 339MapperListener.lifecycleEvent(LifecycleEvent) line: 411LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext(LifecycleBase).setState(LifecycleState, Object) line: 325StandardContext(LifecycleBase).setState(LifecycleState) line: 305StandardContext(LifecycleBase).start() line: 156StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140(6) Register wrapper.It succeeds because context has been registered on Mapper.Mapper.addWrapper(String, String, String, Object, boolean) line: 328MapperListener.registerWrapper(Wrapper) line: 394MapperListener.registerContext(Context) line: 343MapperListener.lifecycleEvent(LifecycleEvent) line: 411LifecycleSupport.fireLifecycleEvent(String, Object) line: 119StandardContext(LifecycleBase).fireLifecycleEvent(String, Object) line: 89StandardContext(LifecycleBase).setState(LifecycleState, Object) line: 325StandardContext(LifecycleBase).setState(LifecycleState) line: 305StandardContext(LifecycleBase).start() line: 156StandardHost(ContainerBase).startInternal() line: 1027StandardHost.startInternal() line: 788StandardHost(LifecycleBase).start() line: 140I think that addWrapper() is unnecessary until LifecycleState for StandardContext become STARTED.addWelcomeFile() is also similar.I attached the patch that prevent this error message.Best regards.", "EB": "", "SR": " Bug 50169Trying to register wrapper and welcomeFile to Mapper before context is registered on Mapper. (4) Register wrapper."}