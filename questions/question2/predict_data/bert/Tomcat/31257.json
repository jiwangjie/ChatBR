{"id": "31257", "title": "Bug 31257java.endorsed.dirs is not used when JSP compilation is forked", "description": " Bug 31257java.endorsed.dirs is not used when JSP compilation is forked When the JSP compiler forks a javac process, it should check to see what thecurrently endorsed directories are (check the systemproperty \"java.endorsed.dirs\"otherwise, classes end up missing and JSPpages do not properly compile.We experienced a problem when we explicitlyset the java.endorsed.dirs property on the command line, and the JSP compilerdid not use it when javac was forked.I have patched org.apache.jasper.compiler.Compiler to support this: src.original\\jakartatomcatjasper\\jasper2\\src\\share\\org\\apache\\jasper\\compiler\\Compiler.javaTue Jun 15 17:30:352004 src\\org\\apache\\jasper\\compiler\\Compiler.javaThu Sep 16 00:05:142004 349,358349,369 extdirs.setPath(exts);javac.setExtdirs(extdirs);info.append(\"extension dir=\" + exts + \"\\n\");}+// Add endorsed directories+String endorsed = System.getProperty(\"java.endorsed.dirs\");+if(endorsed != null) {+Javac.ImplementationSpecificArgument endorsedArg =javac.createCompilerArg();+endorsedArg.setLine(\"JDjava.endorsed.dirs=\"+endorsed);+info.append(\"endorsed dir=\" + endorsed + \"\\n\");+}+else {+info.append(\"no endorsed dirs specified\\n\");+}+// Configure the compiler objectjavac.setEncoding(javaEncoding);javac.setClasspath(path);javac.setDebug(ctxt.getOptions().getClassDebugInfo());true, i should probably check ctxt.getOptions().getFork() in the if() as well,but since i always fork it doesn't matter to me.", "OB": "", "EB": "", "SR": ""}