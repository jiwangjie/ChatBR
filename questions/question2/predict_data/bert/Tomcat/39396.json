{"id": "39396", "title": "Bug 39396OPTIONS request on directory with no default file reports an incorrect list of allowed HTTP verbs", "description": "", "OB": " Bug 39396OPTIONS request on directory with no default file reports an incorrect list of allowed HTTP verbs When an \"options\" http request is made to Tomcat to a directory that has nodefault file (like index.jsp) in it, Tomcat reports a full list of allowedverbs, when in fact, most of them are NOT allowed.For example, a request toa generic img directory:OPTIONS /img/ HTTP/1.0Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2ContentLength: 0Accept: /AcceptLanguage: enusConnection: KeepAliveUserAgent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1; .NET CLR 1.14322; InfoPath.1)Returns:HTTP/1.1 200 OKServer: ApacheCoyote/1.1Allow: GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONSContentLength: 0Date: Mon, 24 Apr 2006 15:11:16 GMTConnection: closeWhich shows several destructive options available (PUT, DELETE).But arequest to DELETE or PUT (correctly) returns a 403 FORBIDDEN result:DELETE /img/ HTTP/1.0Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2ContentLength: 0Accept: /AcceptLanguage: enusConnection: KeepAliveUserAgent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1; .NET CLR 1.14322; InfoPath.1)Returns:HTTP/1.1 403 ForbiddenServer: ApacheCoyote/1.1ContentType: text/html;charset=utf8ContentLength: 964Date: Mon, 24 Apr 2006 15:12:31 GMTConnection: closeBecause the initial OPTIONS request returns a list containing dangerous verbs,the directory will be flagged as a serious security vulnerability by mostscanners (a false positive).The issue DOES NOT occur when the directory HAS a default file in it:OPTIONS /usermanagement/ HTTP/1.0Cookie: JSESSIONID=C46C2E18BE95AD91828C9370CBDF0AF2ContentLength: 0Accept: /AcceptLanguage: enusConnection: KeepAliveUserAgent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;SV1; .NET CLR 1.14322; InfoPath.1)Returns:HTTP/1.1 200 OKServer: ApacheCoyote/1.1SetCookie: JSESSIONID=BC992F0C86E2BCBD0A2E5F1B3A12C50C; Path=/ContentType: text/html;charset=ISO88591Date: Mon, 24 Apr 2006 15:14:27 GMTConnection: close", "EB": "", "SR": ""}