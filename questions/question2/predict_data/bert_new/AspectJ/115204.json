{"id": "115204", "title": "Bug 115204WildAnnotationTypePattern.java:61 NPE after renaming methodannotation class", "description": "Bug 115204WildAnnotationTypePattern.java:61 NPE after renaming methodannotation class Sorry I don't have a small test case.It looks like the NPE happens when theannotation refered to by a (compiled?) aspect no longer exists because it wasrenamed.The class being woven is the first one (alphabetically), and themethod being woven does not have the annotation on it.Let me know if you need a test case. (And sorry for the late bugsI'm just now writing the article. )java.lang.NullPointerExceptionatorg.aspectj.weaver.patterns.WildAnnotationTypePattern.matches(WildAnnotationTypePattern.java:61)atorg.aspectj.weaver.patterns.SignaturePattern.matchesAnnotations(SignaturePattern.java:321)atorg.aspectj.weaver.patterns.SignaturePattern.matchesExactly(SignaturePattern.java:169)at org.aspectj.weaver.patterns.SignaturePattern.matches(SignaturePattern.java:131)atorg.aspectj.weaver.patterns.WithincodePointcut.matchInternal(WithincodePointcut.java:73)at org.aspectj.weaver.patterns.Pointcut.match(Pointcut.java:143)at org.aspectj.weaver.patterns.AndPointcut.matchInternal(AndPointcut.java:55)at org.aspectj.weaver.patterns.Pointcut.match(Pointcut.java:143)at org.aspectj.weaver.patterns.AndPointcut.matchInternal(AndPointcut.java:55)at org.aspectj.weaver.patterns.Pointcut.match(Pointcut.java:143)at org.aspectj.weaver.ShadowMunger.match(ShadowMunger.java:64)at org.aspectj.weaver.Advice.match(Advice.java:109)at org.aspectj.weaver.bcel.BcelAdvice.match(BcelAdvice.java:97)at org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1749)atorg.aspectj.weaver.bcel.BcelClassWeaver.matchInvokeInstruction(BcelClassWeaver.java:1736)at org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1533)at org.aspectj.weaver.bcel.BcelClassWeaver.match(BcelClassWeaver.java:1359)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:382)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:98)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1478)at org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:1443)at org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:1217)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1021)atorg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:300)atorg.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:178)atorg.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$orgaspectjajdtinternalcompilerCompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)at org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:367)atorg.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:759)atorg.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:225)atorg.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBuildManager.java:151)at org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:122)atorg.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)trouble in:public class com.isberg.articles.aop7.bean.ABeanTest$APlus extends java.lang.Object:TypeMungers: [(BcelTypeMunger ResolvedTypeMunger(Method, java.lang.Stringcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(java.lang.String)))]declares: [declare parents: com.isberg.articles.aop7.bean.ABeanTest$CPlusextends (com.isberg.articles.aop7.bean.ABean$IBean);]private static Throwable ajc$initFailureCausepublic static final com.isberg.articles.aop7.bean.ABeanTest$APlusajc$perSingletonInstancestatic void <clinit():staticinitialization(voidcom.isberg.articles.aop7.bean.ABeanTest$APlus.<clinit())| catch java.lang.ThrowableE0| |INVOKESTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$postClinit ()V(line 125)| catch java.lang.ThrowableE0|GOTO L0|E0: ASTORE0|ALOAD0|PUTSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$initFailureCauseLjava/lang/Throwable;|L0: RETURNstaticinitialization(voidcom.isberg.articles.aop7.bean.ABeanTest$APlus.<clinit())end static void <clinit()void <init():ALOAD0// com.isberg.articles.aop7.bean.ABeanTest$APlusthis(line 125)INVOKESPECIAL java.lang.Object.<init ()Vconstructorexecution(voidcom.isberg.articles.aop7.bean.ABeanTest$APlus.<init())|RETURNconstructorexecution(voidcom.isberg.articles.aop7.bean.ABeanTest$APlus.<init())end void <init()void ajc$declareparents1()org.aspectj.weaver.MethodDeclarationLineNumber: 127:3678:RETURN(line 127)end void ajc$declareparents1()public static Stringajc$interMethod$comisbergarticlesaop7beanABeanTest$APlus$comisbergarticlesaop7beanABeanTest$CPlus$propertyName(com.isberg.articles.aop7.bean.ABeanTest$CPlus,String)EffectiveSignatureAttribute(java.lang.Stringcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(java.lang.String),methodexecution):methodexecution(java.lang.Stringcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(java.lang.String))|ALOAD0// com.isberg.articles.aop7.bean.ABeanTest$CPlusajc$this(line 132)|ALOAD1// java.lang.String methodName|INVOKESTATICcom.isberg.articles.aop7.bean.ABean.ajc$interMethod$comisbergarticlesaop7beanABean$comisbergarticlesaop7beanABean$IBean$propertyName(Lcom/isberg/articles/aop7/bean/ABean$IBean;Ljava/lang/String;)Ljava/lang/String;|ASTORE2|LDC \"something\"(line 133)|ALOAD2// java.lang.String result| methodcall(boolean java.lang.String.equals(java.lang.Object))| |INVOKEVIRTUAL java.lang.String.equals (Ljava/lang/Object;)Z| methodcall(boolean java.lang.String.equals(java.lang.Object))|IFEQ L0|LDC \"a\"(line 134)|ASTORE2// java.lang.String result|L0: ALOAD2// java.lang.String result(line 136)|ARETURNmethodexecution(java.lang.Stringcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(java.lang.String))end public static Stringajc$interMethod$comisbergarticlesaop7beanABeanTest$APlus$comisbergarticlesaop7beanABeanTest$CPlus$propertyName(com.isberg.articles.aop7.bean.ABeanTest$CPlus,String)public static Stringajc$interMethodDispatch1$comisbergarticlesaop7beanABeanTest$APlus$comisbergarticlesaop7beanABeanTest$CPlus$propertyName(com.isberg.articles.aop7.bean.ABeanTest$CPlus,String)EffectiveSignatureAttribute(java.lang.Stringcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(java.lang.String),methodcall):ALOAD0ALOAD1INVOKEVIRTUALcom.isberg.articles.aop7.bean.ABeanTest$CPlus.propertyName(Ljava/lang/String;)Ljava/lang/String;ARETURNend public static Stringajc$interMethodDispatch1$comisbergarticlesaop7beanABeanTest$APlus$comisbergarticlesaop7beanABeanTest$CPlus$propertyName(com.isberg.articles.aop7.bean.ABeanTest$CPlus,String)public static com.isberg.articles.aop7.bean.ABeanTest$APlus aspectOf()org.aspectj.weaver.AjAttribute$AjSynthetic@591171:GETSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$perSingletonInstanceLcom/isberg/articles/aop7/bean/ABeanTest$APlus;IFNONNULL L0NEW org.aspectj.lang.NoAspectBoundExceptionDUPLDC \"comisbergarticlesaop7beanABeanTest$APlus\"GETSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$initFailureCauseLjava/lang/Throwable;INVOKESPECIAL org.aspectj.lang.NoAspectBoundException.<init(Ljava/lang/String;Ljava/lang/Throwable;)VATHROWL0: GETSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$perSingletonInstanceLcom/isberg/articles/aop7/bean/ABeanTest$APlus;ARETURNend public static com.isberg.articles.aop7.bean.ABeanTest$APlus aspectOf()public static boolean hasAspect()org.aspectj.weaver.AjAttribute$AjSynthetic@16e3eb3:GETSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$perSingletonInstanceLcom/isberg/articles/aop7/bean/ABeanTest$APlus;IFNULL L0ICONST1IRETURNL0: ICONST0IRETURNend public static boolean hasAspect()private static void ajc$postClinit()org.aspectj.weaver.AjAttribute$AjSynthetic@d7cf62:NEW com.isberg.articles.aop7.bean.ABeanTest$APlusDUPINVOKESPECIALcom.isberg.articles.aop7.bean.ABeanTest$APlus.<init ()VPUTSTATICcom.isberg.articles.aop7.bean.ABeanTest$APlus.ajc$perSingletonInstanceLcom/isberg/articles/aop7/bean/ABeanTest$APlus;RETURNend private static void ajc$postClinit()end public class com.isberg.articles.aop7.bean.ABeanTest$APluswhen matching pointcut ((withincode(@(Parallel)(..)) && call(void (..))) &&percflow(com.isberg.articles.aop7.concurrent.ParallelMethodImpl onexecution(@(Parallel)(..))))when matching shadow methodcall(boolean java.lang.String.equals(java.lang.Object))when weaving type com.isberg.articles.aop7.bean.ABeanTest$APluswhen weaving aspectswhen weavingwhen batch buildingBuildConfig[c:\\home\\ws\\main31\\.metadata\\.plugins\\org.eclipse.ajdt.core\\devworksfall.generated.lst]Files=70 ", "OB": "", "EB": "", "SR": ""}