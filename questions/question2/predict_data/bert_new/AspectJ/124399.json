{"id": "124399", "title": "Bug 124399AJDT AspectJ Internal Compiler Error", "description": "Bug 124399AJDT AspectJ Internal Compiler Error In Eclipse 3.1.1 with AJDT 1.3 (the December 20th 2005 release) I got this message in an error dialog:org.aspectj.weaver.BCExceptionat org.aspectj.weaver.bcel.LazyClassGen.getLazyMethodGen(LazyClassGen.java:1216)at org.aspectj.weaver.bcel.LazyClassGen.getLazyMethodGen(LazyClassGen.java:1201)at org.aspectj.weaver.bcel.BcelShadow.weaveAroundInline(BcelShadow.java:2048)at org.aspectj.weaver.bcel.BcelAdvice.implementOn(BcelAdvice.java:232)at org.aspectj.weaver.Shadow.implementMungers(Shadow.java:588)at org.aspectj.weaver.Shadow.implement(Shadow.java:405)at org.aspectj.weaver.bcel.BcelClassWeaver.implement(BcelClassWeaver.java:2146)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:467)at org.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:102)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1543)at org.aspectj.weaver.bcel.BcelWeaver.weaveWithoutDump(BcelWeaver.java:1494)at org.aspectj.weaver.bcel.BcelWeaver.weaveAndNotify(BcelWeaver.java:1275)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:1097)at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.weave(AjCompilerAdapter.java:300)at org.aspectj.ajdt.internal.compiler.AjCompilerAdapter.afterCompiling(AjCompilerAdapter.java:178)at org.aspectj.ajdt.internal.compiler.CompilerAdapter.ajc$afterReturning$orgaspectjajdtinternalcompilerCompilerAdapter$2$f9cc9ca0(CompilerAdapter.aj:70)at org.aspectj.org.eclipse.jdt.internal.compiler.Compiler.compile(Compiler.java:367)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.performCompilation(AjBuildManager.java:811)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.doBuild(AjBuildManager.java:254)at org.aspectj.ajdt.internal.core.builder.AjBuildManager.incrementalBuild(AjBuildManager.java:163)at org.aspectj.ajde.internal.CompilerAdapter.compile(CompilerAdapter.java:117)at org.aspectj.ajde.internal.AspectJBuildManager$CompilerThread.run(AspectJBuildManager.java:191)trouble in:public class edu.ucsd.aosd.MyApplication extends java.lang.Object:public void <init():ALOAD0// edu.ucsd.aosd.MyApplication this(line 5)INVOKESPECIAL java.lang.Object.<init ()Vconstructorexecution(void edu.ucsd.aosd.MyApplication.<init())|RETURNconstructorexecution(void edu.ucsd.aosd.MyApplication.<init())end public void <init()public static void main(String[])org.aspectj.weaver.MethodDeclarationLineNumber: 8:124:methodexecution(void edu.ucsd.aosd.MyApplication.main(java.lang.String[]))|ALOAD0// java.lang.String[] args(line 9)|ASTORE 4|ICONST0|ISTORE2|ALOAD 4|ARRAYLENGTH|ISTORE3|GOTO L1|L0: ALOAD 4|ILOAD2|AALOAD|ASTORE1|GETSTATIC java.lang.System.out Ljava/io/PrintStream;(line 10)|NEW java.lang.StringBuilder|DUP|LDC \"got: \"|INVOKESPECIAL java.lang.StringBuilder.<init (Ljava/lang/String;)V|ALOAD1// java.lang.String arg| methodcall(java.lang.StringBuilder java.lang.StringBuilder.append(java.lang.String))| |INVOKEVIRTUAL java.lang.StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;| methodcall(java.lang.StringBuilder java.lang.StringBuilder.append(java.lang.String))| methodcall(java.lang.String java.lang.StringBuilder.toString())| |INVOKEVIRTUAL java.lang.StringBuilder.toString ()Ljava/lang/String;| methodcall(java.lang.String java.lang.StringBuilder.toString())|ASTORE 5|ASTORE 6| methodcall(void java.io.PrintStream.println(java.lang.String))| |ALOAD 6| |ALOAD 5| |INVOKEVIRTUAL java.io.PrintStream.println (Ljava/lang/String;)V| methodcall(void java.io.PrintStream.println(java.lang.String))|GETSTATIC java.lang.System.out Ljava/io/PrintStream;(line 11)|LDC \"got: %s\\n\"|ICONST1|ANEWARRAY java.lang.Object|DUP|ICONST0|ALOAD1// java.lang.String arg|AASTORE| methodcall(java.io.PrintStream java.io.PrintStream.printf(java.lang.String, java.lang.Object[]))| |INVOKEVIRTUAL java.io.PrintStream.printf (Ljava/lang/String;[Ljava/lang/Object;)Ljava/io/PrintStream;| methodcall(java.io.PrintStream java.io.PrintStream.printf(java.lang.String, java.lang.Object[]))|POP|IINC 2 1(line 9)|L1: ILOAD2|ILOAD3|IFICMPLT L0|RETURN(line 13)methodexecution(void edu.ucsd.aosd.MyApplication.main(java.lang.String[]))end public static void main(String[])end public class edu.ucsd.aosd.MyApplicationwhen implementing on shadow methodcall(void java.io.PrintStream.println(java.lang.String))when weaving type edu.ucsd.aosd.MyApplicationwhen weaving classeswhen weavingwhen incrementally building BuildConfig[C:\\EclipseWorkspace\\.metadata\\.plugins\\org.eclipse.ajdt.core\\AspectJSemanticsTest.generated.lst] Files=2It occured when I editing this file, in an AspectJ project with an recently renamed .aj extension:package edu.ucsd.aosd;import java.io.PrintStream;public class MyApplication{// mainpublic static void main(String[] args) {for (String arg : args) {System.out.println(\"got: \" + arg);System.out.printf(\"got: %s\\n\", arg);}}}aspect Printing {pointcut printlnCalls(PrintStream ps, String out):call( PrintStream+.println(String)) && target(ps) && args(out);Object around(PrintStream ps, String out):printlnCalls(ps, out) && !adviceexecution() {return proceed(ps, out);}pointcut printfCalls(PrintStream ps, String fmt, Object[] objs):call( PrintStream+.printf(String, Object...))&& target(ps) && args(fmt, objs);}Where \"\" is where my cursor was when I saved. My previously saved version didn't have the printfCalls pointcut nor the call to printf in the main. (Thus, you might want to try the println version first, save it, and then make the new additions. Though, I hope the debug information is enough.) ", "OB": "", "EB": "", "SR": ""}