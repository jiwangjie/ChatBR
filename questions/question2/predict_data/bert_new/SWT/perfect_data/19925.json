{"id": "19925", "title": "Bug 19925Error opening doc file causes much grief", "description": "Build: 20020611JDK: IBM JDK 1.3.120020403I get an error every time I try to open a .docfile.Follow these steps:1. (see attachment)4. CALLBACK.DOC is opened in WordPad.2. The following appears in thelog:!SESSION Jun 11, 2002 13:19:05.181 java.fullversion=J2RE 1.3.1 IBM Windows 32build cn13120020403 (JIT enabled: jitc)BootLoader constants: OS=win32, ARCH=x86,WS=win32, NL=enUSCommandline arguments: os win32 ws win32 arch x86 datac:\\home\\workspaces\\doctest0611 installfile:C:/home/eclipse/eclipse0611/eclipse/!ENTRY org.eclipse.ui 4 2 Jun 11, 200213:19:05.181!MESSAGE Problems occurred when invoking code from plugin:\"org.eclipse.ui\". !STACK 0java.lang.NullPointerExceptionatorg.eclipse.ui.internal.editorsupport.win32.OleEditor.oleActivate(OleEditor.java:551)atorg.eclipse.ui.internal.editorsupport.win32.OleEditor.activateClient(OleEditor.java:168)atorg.eclipse.ui.internal.editorsupport.win32.OleEditor.access$3(OleEditor.java:166)atorg.eclipse.ui.internal.editorsupport.win32.OleEditor$4.partActivated(OleEditor.java:126)atorg.eclipse.ui.internal.PartListenerList$1.run(PartListenerList.java:39)atorg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:802)atorg.eclipse.core.runtime.Platform.run(Platform.java:416)atorg.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:37)atorg.eclipse.ui.internal.WorkbenchPage.firePartActivated(WorkbenchPage.java:1031)atorg.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:2039)atorg.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:330)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1685)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1581)atorg.eclipse.ui.actions.OpenFileAction.openFile(OpenFileAction.java:91)atorg.eclipse.ui.actions.OpenSystemEditorAction.run(OpenSystemEditorAction.java:91)atorg.eclipse.ui.views.navigator.OpenActionGroup.runDefaultAction(OpenActionGroup.java:112)atorg.eclipse.ui.views.navigator.MainActionGroup.runDefaultAction(MainActionGroup.java:177)atorg.eclipse.ui.views.navigator.ResourceNavigator.handleOpen(ResourceNavigator.java:531)atorg.eclipse.ui.views.navigator.ResourceNavigator$6.open(ResourceNavigator.java:303)atorg.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:320)atorg.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:494)atorg.eclipse.jface.viewers.StructuredViewer$3.handleOpen(StructuredViewer.java:581)atorg.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:198)atorg.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:195)atorg.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:222)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:825)atorg.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1527)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1289)atorg.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)atorg.eclipse.ui.internal.Workbench.run(Workbench.java:1160)atorg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:739)atorg.eclipse.core.boot.BootLoader.run(BootLoader.java:462)atjava.lang.reflect.Method.invoke(Native Method)atorg.eclipse.core.launcher.Main.basicRun(Main.java:248)atorg.eclipse.core.launcher.Main.run(Main.java:697)atorg.eclipse.core.launcher.Main.main(Main.java:530)!ENTRY org.eclipse.ui 4 4 Jun 11,2002 13:19:05.321!MESSAGE Unhandled exception caught in event loop. !ENTRYorg.eclipse.ui 4 0 Jun 11, 2002 13:19:05.331!MESSAGEjava.lang.NullPointerException!STACK 0java.lang.NullPointerExceptionatorg.eclipse.swt.ole.win32.OleClientSite.onPaint(OleClientSite.java:824)atorg.eclipse.swt.ole.win32.OleClientSite.access$2(OleClientSite.java:819)atorg.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(OleClientSite.java:122)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:841)atorg.eclipse.swt.widgets.Composite.WMPAINT(Composite.java:663)atorg.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))atorg.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))atorg.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)atorg.eclipse.swt.internal.win32.OS.DispatchMessage(OS.java:1219)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1287)atorg.eclipse.jface.window.Window.runEventLoop(Window.java:557)atorg.eclipse.jface.window.Window.open(Window.java:537)atorg.eclipse.jface.dialogs.MessageDialog.openError(MessageDialog.java:318)atorg.eclipse.jface.util.SafeRunnable.handleException(SafeRunnable.java:42)atorg.eclipse.ui.internal.PartListenerList$1.handleException(PartListenerList.java:42)atorg.eclipse.core.internal.runtime.InternalPlatform.handleException(InternalPlatform.java:427)atorg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:804)atorg.eclipse.core.runtime.Platform.run(Platform.java:416)atorg.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:37)atorg.eclipse.ui.internal.WorkbenchPage.firePartActivated(WorkbenchPage.java:1031)atorg.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:2039)atorg.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:330)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1685)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1581)atorg.eclipse.ui.actions.OpenFileAction.openFile(OpenFileAction.java:91)atorg.eclipse.ui.actions.OpenSystemEditorAction.run(OpenSystemEditorAction.java:91)atorg.eclipse.ui.views.navigator.OpenActionGroup.runDefaultAction(OpenActionGroup.java:112)atorg.eclipse.ui.views.navigator.MainActionGroup.runDefaultAction(MainActionGroup.java:177)atorg.eclipse.ui.views.navigator.ResourceNavigator.handleOpen(ResourceNavigator.java:531)atorg.eclipse.ui.views.navigator.ResourceNavigator$6.open(ResourceNavigator.java:303)atorg.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:320)atorg.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:494)atorg.eclipse.jface.viewers.StructuredViewer$3.handleOpen(StructuredViewer.java:581)atorg.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:198)atorg.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:195)atorg.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:222)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:825)atorg.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1527)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1289)atorg.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)atorg.eclipse.ui.internal.Workbench.run(Workbench.java:1160)atorg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:739)atorg.eclipse.core.boot.BootLoader.run(BootLoader.java:462)atjava.lang.reflect.Method.invoke(Native Method)atorg.eclipse.core.launcher.Main.basicRun(Main.java:248)atorg.eclipse.core.launcher.Main.run(Main.java:697)atorg.eclipse.core.launcher.Main.main(Main.java:530)!ENTRY org.eclipse.ui 4 4 Jun 11,2002 13:20:02.393!MESSAGE Unhandled exception caught in event loop. !ENTRYorg.eclipse.ui 4 0 Jun 11, 2002 13:20:02.393!MESSAGEjava.lang.NullPointerException!STACK 0java.lang.NullPointerExceptionatatorg.eclipse.swt.ole.win32.OleClientSite.access$2(OleClientSite.java:819)atorg.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(OleClientSite.java:122)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:841)atorg.eclipse.swt.widgets.Composite.WMPAINT(Composite.java:663)atorg.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))atorg.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))atorg.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))atorg.eclipse.jface.window.Window.runEventLoop(Window.java(Compiled Code))atorg.eclipse.jface.window.Window.open(Window.java:537)atorg.eclipse.jface.dialogs.MessageDialog.openError(MessageDialog.java:318)atorg.eclipse.jface.util.SafeRunnable.handleException(SafeRunnable.java:42)atorg.eclipse.ui.internal.PartListenerList$1.handleException(PartListenerList.java:42)atorg.eclipse.core.internal.runtime.InternalPlatform.handleException(InternalPlatform.java:427)atorg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:804)atorg.eclipse.core.runtime.Platform.run(Platform.java:416)atorg.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:37)atorg.eclipse.ui.internal.WorkbenchPage.firePartActivated(WorkbenchPage.java:1031)atorg.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:2039)atorg.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:330)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1685)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1581)atorg.eclipse.ui.actions.OpenFileAction.openFile(OpenFileAction.java:91)atorg.eclipse.ui.actions.OpenSystemEditorAction.run(OpenSystemEditorAction.java:91)atorg.eclipse.ui.views.navigator.OpenActionGroup.runDefaultAction(OpenActionGroup.java:112)atorg.eclipse.ui.views.navigator.MainActionGroup.runDefaultAction(MainActionGroup.java:177)atorg.eclipse.ui.views.navigator.ResourceNavigator.handleOpen(ResourceNavigator.java:531)atorg.eclipse.ui.views.navigator.ResourceNavigator$6.open(ResourceNavigator.java:303)atorg.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:320)atorg.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:494)atorg.eclipse.jface.viewers.StructuredViewer$3.handleOpen(StructuredViewer.java:581)atorg.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:198)atorg.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:195)atorg.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:222)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:825)atorg.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1527)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1289)atorg.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)atorg.eclipse.ui.internal.Workbench.run(Workbench.java:1160)atorg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:739)atorg.eclipse.core.boot.BootLoader.run(BootLoader.java:462)atjava.lang.reflect.Method.invoke(Native Method)atorg.eclipse.core.launcher.Main.basicRun(Main.java:248)atorg.eclipse.core.launcher.Main.run(Main.java:697)atorg.eclipse.core.launcher.Main.main(Main.java:530)!ENTRY org.eclipse.ui 4 4 Jun 11,2002 13:21:23.500!MESSAGE Unhandled exception caught in event loop. !ENTRYorg.eclipse.ui 4 0 Jun 11, 2002 13:21:23.500!MESSAGEjava.lang.NullPointerException!STACK 0java.lang.NullPointerExceptionatatorg.eclipse.swt.ole.win32.OleClientSite.access$2(OleClientSite.java:819)atorg.eclipse.swt.ole.win32.OleClientSite$1.handleEvent(OleClientSite.java:122)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:841)atorg.eclipse.swt.widgets.Composite.WMPAINT(Composite.java:663)atorg.eclipse.swt.widgets.Control.windowProc(Control.java(Compiled Code))atorg.eclipse.swt.widgets.Display.windowProc(Display.java(Compiled Code))atorg.eclipse.swt.internal.win32.OS.DispatchMessageW(Native Method)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java(Compiled Code))atorg.eclipse.jface.window.Window.runEventLoop(Window.java(Compiled Code))atorg.eclipse.jface.window.Window.open(Window.java:537)atorg.eclipse.jface.dialogs.MessageDialog.openError(MessageDialog.java:318)atorg.eclipse.jface.util.SafeRunnable.handleException(SafeRunnable.java:42)atorg.eclipse.ui.internal.PartListenerList$1.handleException(PartListenerList.java:42)atorg.eclipse.core.internal.runtime.InternalPlatform.handleException(InternalPlatform.java:427)atorg.eclipse.core.internal.runtime.InternalPlatform.run(InternalPlatform.java:804)atorg.eclipse.core.runtime.Platform.run(Platform.java:416)atorg.eclipse.ui.internal.PartListenerList.firePartActivated(PartListenerList.java:37)atorg.eclipse.ui.internal.WorkbenchPage.firePartActivated(WorkbenchPage.java:1031)atorg.eclipse.ui.internal.WorkbenchPage.setActivePart(WorkbenchPage.java:2039)atorg.eclipse.ui.internal.WorkbenchPage.activate(WorkbenchPage.java:330)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1685)atorg.eclipse.ui.internal.WorkbenchPage.openEditor(WorkbenchPage.java:1581)atorg.eclipse.ui.actions.OpenFileAction.openFile(OpenFileAction.java:91)atorg.eclipse.ui.actions.OpenSystemEditorAction.run(OpenSystemEditorAction.java:91)atorg.eclipse.ui.views.navigator.OpenActionGroup.runDefaultAction(OpenActionGroup.java:112)atorg.eclipse.ui.views.navigator.MainActionGroup.runDefaultAction(MainActionGroup.java:177)atorg.eclipse.ui.views.navigator.ResourceNavigator.handleOpen(ResourceNavigator.java:531)atorg.eclipse.ui.views.navigator.ResourceNavigator$6.open(ResourceNavigator.java:303)atorg.eclipse.jface.viewers.StructuredViewer.fireOpen(StructuredViewer.java:320)atorg.eclipse.jface.viewers.StructuredViewer.handleOpen(StructuredViewer.java:494)atorg.eclipse.jface.viewers.StructuredViewer$3.handleOpen(StructuredViewer.java:581)atorg.eclipse.jface.util.OpenStrategy.fireOpenEvent(OpenStrategy.java:198)atorg.eclipse.jface.util.OpenStrategy.access$2(OpenStrategy.java:195)atorg.eclipse.jface.util.OpenStrategy$1.handleEvent(OpenStrategy.java:222)atorg.eclipse.swt.widgets.EventTable.sendEvent(EventTable.java(Compiled Code))atorg.eclipse.swt.widgets.Widget.sendEvent(Widget.java:825)atorg.eclipse.swt.widgets.Display.runDeferredEvents(Display.java:1527)atorg.eclipse.swt.widgets.Display.readAndDispatch(Display.java:1289)atorg.eclipse.ui.internal.Workbench.runEventLoop(Workbench.java:1177)atorg.eclipse.ui.internal.Workbench.run(Workbench.java:1160)atorg.eclipse.core.internal.boot.InternalBootLoader.run(InternalBootLoader.java:739)atorg.eclipse.core.boot.BootLoader.run(BootLoader.java:462)atjava.lang.reflect.Method.invoke(Native Method)atorg.eclipse.core.launcher.Main.basicRun(Main.java:248)atorg.eclipse.core.launcher.Main.run(Main.java:697)atorg.eclipse.core.launcher.Main.main(Main.java:530)As I see it, there are 5 parts tothis bug:1. Can't open .doc files without an error2. Error handling near OLE needs to guardagainst two editors (both internal & external)3. ", "OB": "Bug 19925Error opening doc file causes much grief Double click CALLBACK.DOC <Error occurs5. Try to exit Eclipse, no can do!Terminate Eclipse with a CtrlC.6. RelaunchEclipse... CALLBACK.DOC (& the error) returns (run screaming to the hills, AIIEEE! CALLBACK.DOC isalso opened in a blank editor in Eclipse.3. The Eclipse editor for CALLBACK.DOC is markeddirty.Revert is greyed out in the File menu, and every attempt to close CALLBACK.DOC fails, i.e.when you click the Editor X you get prompted to save, no matter what answer you give, the fileremains open.This is especially nasty because it means you can't close Eclipse.I had toterminate the process with a CtrlC in the Java console.4. No way to close the dirty editor thatappears4. Loose \"save file\" handling makes clean shutdown impossible5. ", "EB": "Restore codeshouldn't restore faulty editors (particularly dirty ones!) ", "SR": "New workspace2. New simple project \"Docs\".3. Drag &drop CALLBACK.DOC from the desktop into Docs. Try to exit Eclipse, no can do!Terminate Eclipse with a CtrlC.6. )Thefollowing things happen at step 5:1. The Eclipse editor for CALLBACK.DOC is markeddirty.Revert is greyed out in the File menu, and every attempt to close CALLBACK.DOC fails, i.e.when you click the Editor X you get prompted to save, no matter what answer you give, the fileremains open.This is especially nasty because it means you can't close Eclipse.I had toterminate the process with a CtrlC in the Java console.4. "}