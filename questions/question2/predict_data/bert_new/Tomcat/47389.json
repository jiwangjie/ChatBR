{"id": "47389", "title": "Bug 47389DeltaManager doesn't do the session replication. (notifySessionListenersOnReplication=false)", "description": "Bug 47389DeltaManager doesn't do the session replication. (notifySessionListenersOnReplication=false) ]Index: java/org/apache/catalina/ha/session/DeltaManager.java=================================================================== java/org/apache/catalina/ha/session/DeltaManager.java(revision 763870)+++ java/org/apache/catalina/ha/session/DeltaManager.java(working copy)@@ 1435,10 +1435,12 @@// use container maxInactiveInterval so that session will expire correctly in case of primary transfersession.setMaxInactiveInterval(getMaxInactiveInterval());session.access();if(notifySessionListenersOnReplication)+if(notifySessionListenersOnReplication) {session.setId(msg.getSessionID());else+} else {session.setIdInternal(msg.getSessionID());+add(session);+}session.resetDeltaRequest();session.endAccess();[end. ]Best regards. ", "OB": "DeltaManager is used.When notifySessionListenersOnReplication is set to false, session replication is not done.This cause is in the following DeltaManagerhandleSESSIONCREATED's codes.protected void handleSESSIONCREATED(SessionMessage msg,Member sender) {...if(notifySessionListenersOnReplication)session.setId(msg.getSessionID());elsesession.setIdInternal(msg.getSessionID());session.resetDeltaRequest();session.endAccess();}When notifySessionListenersOnReplication is false, only session.setIdInternal is executed.Session is not added to session map of DeltaManager in session.setIdInternal method.As a result, session replication is not done.When notifySessionListenersOnReplication is false,I think that I should add session to session map of DeltaManager.For instance, as follows.[start. ", "EB": "", "SR": ""}