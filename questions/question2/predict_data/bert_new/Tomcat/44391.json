{"id": "44391", "title": "Bug 44391SSI handling of escaped characters broken", "description": "Bug 44391SSI handling of escaped characters broken This is because there are twoconsecutive escaped characters. Although the first one \\\" is detected correctlythe next one isn't because the flag escaped is still set to true, although thischaracter isn't escaped anymore.You have to replaceboolean escaped = false;for (; bIdx < cmd.length() && quotes != 2; bIdx++) {char c = cmd.charAt(bIdx);// Need to skip escaped charactersif (c == '\\\\' && !escaped) {escaped = true;bIdx++;continue;}escaped = false;if (c == '\"') quotes++;}byfor (; bIdx < cmd.length() && quotes != 2; bIdx++) {char c = cmd.charAt(bIdx);// Need to skip escaped charactersif (c == '\\\\') {bIdx++;continue;}if (c == '\"') quotes++;}Just removing the flag escaped is sufficient, because you don't have to rememberwhether the last character was escaped and that should have no influence toconsecutive characters.The bug still exists in the HEAD revision of the repository. ", "OB": "In org.apache.catalina.ssi.SSIProcessor the method parseParamNames is broken. IfI have a SSI directive like <!set var=\"test\" value=\"blubb\\\"\\\"\"the methoddetects three parameters instead of two. ", "EB": "", "SR": ""}