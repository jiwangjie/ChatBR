{"id": "49570", "title": "Bug 49570The CompressionFilter example should support HTTP proxies to cache gzipped content better by sending Vary: AcceptEncoding header", "description": "http://httpd.apache.org/docs/2.0/mod/moddeflate.htmlproxies2. ", "OB": "At the moment the Compression Filter example doesn't send the header \"Vary: AcceptEncoding\" with the compressed content (see method writeToGZip(..) in http://svn.apache.org/repos/asf/tomcat/trunk/webapps/examples/WEBINF/classes/compressionFilters/CompressionResponseStream.java).From many sources like1. ", "EB": "Bug 49570The CompressionFilter example should support HTTP proxies to cache gzipped content better by sending Vary: AcceptEncoding header http://developer.yahoo.net/blog/archives/2007/07/highperformanc3.htmlit looks like a \"Vary: AcceptEncoding\" header should be sent with the compressed content to make sure proxy servers can serve gzipped content correctly.To enhance this example, the method writeToGzip(..) should be updated to send Vary: AcceptEncoding header like below:public void writeToGZip(byte b[], int off, int len) throws IOException {...response.addHeader(\"ContentEncoding\", \"gzip\");response.addHeader(\"Vary\", \"AcceptEncoding\");gzipstream = new GZIPOutputStream(output);...} ", "SR": ""}