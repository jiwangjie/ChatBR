{"bug_id": "48109", "title": "Bug 48109Improve binaryStream processing in WebappClassLoaderfindResourceInternal", "description": "(based on http://marc.info/?l=tomcatdev&m=124192105131636&w=2)In WebappClassLoaderfindResourceInternal() there is a lot of code between opening the binaryStream and starting to use it.There is a lot of processing, e.g.:if (!openJARs()) {return null;}if (antiJARLocking).If something happens in those steps, it is possible to leak InputStream references.One case is fixed with rev.772872,but it would be better to add a global try/finally block."}