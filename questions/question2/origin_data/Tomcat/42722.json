{"bug_id": "42722", "title": "Bug 42722Potential NullPointerException in org.apache.catalina.servlets.CGIServlet", "description": "There is a potential NPE in CGIServlet, even if it's unlikely it may happen.The following patch resolves this problem:Index:F:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java===================================================================F:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java(revision 548385)+++F:/Workspace/Apache2/tomcat6/java/org/apache/catalina/servlets/CGIServlet.java(working copy)@@ 1631,7 +1631,6 @@ with major modifications by Martin Dengler/Runtime rt = null;InputStream cgiOutput = null;BufferedReader commandsStdErr = null;BufferedOutputStream commandsStdIn = null;Process proc = null;@@ 1700,7 +1699,9 @@new HTTPHeaderInputStream(proc.getInputStream());BufferedReader cgiHeaderReader =new BufferedReader(new InputStreamReader(cgiHeaderStream));++InputStream cgiOutput = null;+while (isRunning) {try {//set headers@@ 1763,7 +1764,10 @@} //replacement for Process.waitFor()// Close the output stream usedcgiOutput.close();+if (cgiOutput != null)+{+cgiOutput.close();+}}catch (IOException e){log (\"Caught exception \" + e);"}