{"bug_id": "32239", "title": "Bug 32239Dumps assembly code if Object[] used in args (BcelRenderer.java:152)", "description": "PROGRAMimport org.aspectj.lang.;import java.lang.reflect.;import org.aspectj.lang.reflect.;public class Test4 {public static void main(String[] args) throws Exception {Test4 t = new Test4();System.out.println(t.foo(\"a\"));}String foo(Object s) {return \"x\"+s;}}aspect profile {// It's the [] that is offending the compilerObject around(Object targ, Object[] x): call( (..)) && target(targ) &&!within(profile) && args(x) {System.out.println(\"\" + targ + \",\" + x);return proceed(targ,x);}}RESULT OF COMPILATION[erik@oden test] ajc Test4.javatrouble in:public class Test4 extends java.lang.Object:public void <init():ALOAD0// Test4 this(line 5)INVOKESPECIAL java.lang.Object.<init ()Vconstructorexecution(void Test4.<init())|RETURNconstructorexecution(void Test4.<init())end public void <init()public static void main(String[]) throws java.lang.Exception:methodexecution(void Test4.main(java.lang.String[]))|NEW Test4(line 7)|DUP| constructorcall(void Test4.<init())| |INVOKESPECIAL Test4.<init ()V| constructorcall(void Test4.<init())|ASTORE1| fieldget(java.io.PrintStream java.lang.System.out)| |GETSTATIC java.lang.System.out Ljava/io/PrintStream;(line8)| fieldget(java.io.PrintStream java.lang.System.out)|ALOAD1// Test4 t|LDC \"a\"|ASTORE2|ASTORE3| methodcall(void java.io.PrintStream.println(java.lang.String))| |INVOKEVIRTUAL java.io.PrintStream.println(Ljava/lang/String;)V| methodcall(void java.io.PrintStream.println(java.lang.String))|RETURN(line 9)methodexecution(void Test4.main(java.lang.String[]))end public static void main(String[]) throws java.lang.ExceptionString foo(Object):methodexecution(java.lang.String Test4.foo(java.lang.Object))|NEW java.lang.StringBuffer(line 11)|DUP|LDC \"x\"| constructorcall(void java.lang.StringBuffer.<init(java.lang.String))| |INVOKESPECIAL java.lang.StringBuffer.<init(Ljava/lang/String;)V| constructorcall(void java.lang.StringBuffer.<init(java.lang.String))|ALOAD1// java.lang.Object s| methodcall(java.lang.StringBufferjava.lang.StringBuffer.append(java.lang.Object))| |INVOKEVIRTUAL java.lang.StringBuffer.append(Ljava/lang/Object;)Ljava/lang/StringBuffer;| methodcall(java.lang.StringBufferjava.lang.StringBuffer.append(java.lang.Object))| methodcall(java.lang.String java.lang.StringBuffer.toString())| |INVOKEVIRTUAL java.lang.StringBuffer.toString()Ljava/lang/String;| methodcall(java.lang.String java.lang.StringBuffer.toString())|ARETURNmethodexecution(java.lang.String Test4.foo(java.lang.Object))end String foo(Object)static final String fooaroundBody0(Test4, Object):ALOAD0ALOAD1INVOKEVIRTUAL Test4.foo(Ljava/lang/Object;)Ljava/lang/String;(line 8)ARETURNend static final String fooaroundBody0(Test4, Object)end public class Test4Exception thrown from AspectJ 1.1beta4This might be logged as a bug already  see the bug database athttp://dev.eclipse.org (product: AspectJ, component: compiler)Bugs for exceptions thrown have titles File:line from the top stack,e.g., \"SomeFile.java:243\"If you don't find the exception below in a bug, please add a new bugTo make the bug a priority, please include a test programthat can reproduce this exception.org.apache.bcel.generic.ArrayTypeorg.apache.bcel.generic.ArrayTypejava.lang.ClassCastException: org.apache.bcel.generic.ArrayTypeat org.aspectj.weaver.bcel.BcelRenderer.visit(BcelRenderer.java:152)at org.aspectj.weaver.ast.Instanceof.accept(Instanceof.java:29)at org.aspectj.weaver.bcel.BcelRenderer.recur(BcelRenderer.java:128)at org.aspectj.weaver.bcel.BcelRenderer.renderTest(BcelRenderer.java:94)atorg.aspectj.weaver.bcel.BcelAdvice.getTestInstructions(BcelAdvice.java:271)atorg.aspectj.weaver.bcel.BcelShadow.weaveAroundInline(BcelShadow.java:1199)at org.aspectj.weaver.bcel.BcelAdvice.implementOn(BcelAdvice.java:117)at org.aspectj.weaver.Shadow.implementMungers(Shadow.java:306)at org.aspectj.weaver.Shadow.implement(Shadow.java:278)atorg.aspectj.weaver.bcel.BcelClassWeaver.implement(BcelClassWeaver.java:917)atorg.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:244)atorg.aspectj.weaver.bcel.BcelClassWeaver.weave(BcelClassWeaver.java:35)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:312)at org.aspectj.weaver.bcel.BcelWeaver.weave(BcelWeaver.java:264)atorg.aspectj.ajdt.internal.core.builder.AjBuildManager.weaveAndGenerateClassFiles(AjBuildManager.java:351)atorg.aspectj.ajdt.internal.core.builder.AjBuildManager.batchBuild(AjBuildManager.java:112)at org.aspectj.ajdt.ajc.AjdtCommand.runCommand(AjdtCommand.java:54)at org.aspectj.tools.ajc.Main.run(Main.java:199)at org.aspectj.tools.ajc.Main.runMain(Main.java:138)at org.aspectj.tools.ajc.Main.main(Main.java:58)1 fail|abort"}