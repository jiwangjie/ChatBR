{"id": "49503", "title": "Bug 49503: Connectors do not bind to their ports in Catalina.load(), but only later in start()", "description": "Bug 49503: Connectors do not bind to their ports in Catalina.load(), but only later in start(). Testing with trunk at revision 957942, so this issue affects version 7.0.0 as well. In TC6, there is a separate prestartup phase when starting Tomcat to allow Connectors to bind to their ports before other parts of Tomcat are started. IIRC, this is implemented by having separate Bootstrap.load(String[]) and Boot.start() methods [1]. Essentially, this behavior breaks the fix for BZ 48625. To reproduce: 1. The first instance starts successfully.", "OB": "When running with jsvc, Tomcat is unable to bind to privileged ports (80). The observed issue occurs when testing the fix for bug 49030 + bug 48625 that was applied in r957960. The second instance fails, but not in the expected way. 3. Actual behavior: The exception does not occur because the connector does not attempt to bind to the port. The binding happens when start() is called. The startup sequence continues and then fails in Server.await().", "EB": "Expected behavior: I would expect that in StandardService.initInternal(), the connector.init() call fails because it cannot bind to the port. The exception from connector.init() should be caught there, and if the EXITONINITFAILURE flag is set, it should be rethrown. Then it should be caught in Catalina.load() and rethrown as an Error, which would abort Tomcat startup.", "SR": "1. Start Tomcat using jsvc. 2. Apply the fix for bug 49030 + bug 48625. 3. Start the second instance. 4. Observe that the exception does not occur and the connector does not bind to the port. 5. Continue the startup sequence and observe the failure in Server.await()."}