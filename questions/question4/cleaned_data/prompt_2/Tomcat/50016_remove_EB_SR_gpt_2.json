{
  "id": "50016",
  "title": "Bug 50016 - Division of Responsibility Issue with isUserInRole and Request Login/Logout Methods",
  "description": "There's a problematic division of responsibility regarding isUserInRole and the new Request login/logout methods. There are 2 issues causing this problem. First, the implementation of Request.isUserInRole attempts to prevent jacc implementations, but it's incorrect. In the current Tomcat implementation, roleref mappings are applied to the supplied role before testing the target role. JACC requires implementing this by constructing a roleref permission with the current servlet name and the supplied (not mapped) role. Secondly, the implementation of the new login and logout methods intrudes excessively into authentication internals. Specifically, the restriction of checking for installed Authenticators supporting user/password login is too limiting, potentially neglecting other installed authenticators.",
  "OB": "The new login and logout methods excessively intrude into authentication internals, particularly by checking for a specific Authenticator installation to support user/password login, potentially overlooking other installed authenticators.",
  "EB": "The division of responsibility needs improvement. Specifically, the implementation of isUserInRole and the new login/logout methods should align with JACC requirements for role checking and should not overly restrict authentication to specific Authenticators.",
  "SR": "Steps to Reproduce:\n1. Use Request.isUserInRole in Tomcat with role ref mappings.\n2. Observe the incorrect application of role ref mappings before testing the target role.\n3. Try using different authentication methods and note the limitations imposed by the authentication checks specifically geared towards user/password login."
}
