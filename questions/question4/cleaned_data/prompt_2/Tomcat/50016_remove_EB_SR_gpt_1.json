{
  "id": "50016",
  "title": "Bad Division of Responsibility in isUserInRole and New Request Login/Logout Methods",
  "description": "The issue at hand pertains to the division of responsibility in isUserInRole and the recently introduced login and logout methods. The current implementation faces two main problems:\n1. The method Request.isUserInRole attempts to prevent JACC implementations, which is incorrect. The Tomcat implementation applies role mappings before testing the target role. JACC requires constructing a roleref permission with the servlet's current name and the supplied (unmapped) role.\n2. The new login and logout methods exhibit an excessively intrusive behavior within authentication internals. Specifically, the restriction of checking for installed Authenticators to support user/password login is overly constrictive since there might be other authenticators installed.",
  "OB": "The user isn't in the mapped role; the original role is tested. However, the new login/logout methods' implementation excessively intrudes into authentication internals. Specifically, restricting login support checking only for known Authenticators can be overly limiting due to other potential authenticators being installed.",
  "EB": "The user role mapping and testing need a clearer flow and adherence to JACC requirements. Additionally, the login/logout methods should be revised to be less intrusive, allowing for broader authentication support beyond known Authenticators.",
  "SR": "Steps to Reproduce:\n1. Attempt to utilize Request.isUserInRole with role mappings.\n2. Observe the behavior around the tested roles when using the method.\n3. Attempt to perform login and logout operations using the newly introduced methods.\n4. Notice the restrictions or limitations encountered due to the current implementation."
}
